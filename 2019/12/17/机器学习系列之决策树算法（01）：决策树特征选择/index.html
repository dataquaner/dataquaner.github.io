<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>机器学习系列之决策树算法（01）：决策树特征选择 | DataQuaner</title><meta name="description" content="决策树"><meta name="keywords" content="决策树"><meta name="author" content="Leon"><meta name="copyright" content="Leon"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="机器学习系列之决策树算法（01）：决策树特征选择"><meta name="twitter:description" content="决策树"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png"><meta property="og:type" content="article"><meta property="og:title" content="机器学习系列之决策树算法（01）：决策树特征选择"><meta property="og:url" content="https://dataquaner.github.io/2019/12/17/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%B3%BB%E5%88%97%E4%B9%8B%E5%86%B3%E7%AD%96%E6%A0%91%E7%AE%97%E6%B3%95%EF%BC%8801%EF%BC%89%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E7%89%B9%E5%BE%81%E9%80%89%E6%8B%A9/"><meta property="og:site_name" content="DataQuaner"><meta property="og:description" content="决策树"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://dataquaner.github.io/2019/12/17/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%B3%BB%E5%88%97%E4%B9%8B%E5%86%B3%E7%AD%96%E6%A0%91%E7%AE%97%E6%B3%95%EF%BC%8801%EF%BC%89%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E7%89%B9%E5%BE%81%E9%80%89%E6%8B%A9/"><link rel="prev" title="极客时间《数据分析45讲总结》" href="https://dataquaner.github.io/2019/12/17/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4%E3%80%8A%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%9045%E8%AE%B2%E6%80%BB%E7%BB%93%E3%80%8B/"><link rel="next" title="xgboost算法模型输出的解释" href="https://dataquaner.github.io/2019/12/16/xgboost%E7%AE%97%E6%A8%A1%E5%9E%8B%E8%BE%93%E5%87%BA%E7%9A%84%E8%A7%A3%E9%87%8A/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  highlight_copy: 'true',
  highlight_lang: 'true',
  highlight_shrink: 'false',
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  copyright: undefined,
  copy_copyright_js: false,
  ClickShowText: undefined,
  medium_zoom: 'false',
  Snackbar: undefined
  
}</script><link rel="alternate" href="/atom.xml" title="DataQuaner" type="application/atom+xml">
</head><body><div id="header"> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">DataQuaner</a></span><i class="fa fa-bars fa-fw toggle-menu pull_right close" aria-hidden="true"></i><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 类别</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 小憩</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li></ul></div></div></span><span class="pull_right" id="search_button"></span></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="lazyload avatar_img" src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/Photo/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'"></div><div class="mobile_post_data"><div class="mobile_data_item is_center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">7</div></a></div></div><div class="mobile_data_item is_center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">7</div></a></div></div><div class="mobile_data_item is_center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">9</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 类别</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 小憩</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li></ul></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#1-什么是特征选择"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">1.什么是特征选择</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-信息增益"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text">2.信息增益</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#熵（Entropy）"><span class="toc_mobile_items-number">2.1.</span> <span class="toc_mobile_items-text">熵（Entropy）</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#信息增益的定义与信息增益算法"><span class="toc_mobile_items-number">2.2.</span> <span class="toc_mobile_items-text">信息增益的定义与信息增益算法</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#3-信息增益比"><span class="toc_mobile_items-number">3.</span> <span class="toc_mobile_items-text">3.信息增益比</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#4-ID3-：-最大信息增益"><span class="toc_mobile_items-number">4.</span> <span class="toc_mobile_items-text">4. ID3 ： 最大信息增益</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#5-C4-5-：最大信息增益率"><span class="toc_mobile_items-number">5.</span> <span class="toc_mobile_items-text">5. C4.5 ：最大信息增益率</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#6-CART-：最小基尼指数"><span class="toc_mobile_items-number">6.</span> <span class="toc_mobile_items-text">6.CART ：最小基尼指数</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#7-分类树和回归树"><span class="toc_mobile_items-number">6.1.</span> <span class="toc_mobile_items-text">7.分类树和回归树</span></a></li></ol></li></ol></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-什么是特征选择"><span class="toc-number">1.</span> <span class="toc-text">1.什么是特征选择</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-信息增益"><span class="toc-number">2.</span> <span class="toc-text">2.信息增益</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#熵（Entropy）"><span class="toc-number">2.1.</span> <span class="toc-text">熵（Entropy）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#信息增益的定义与信息增益算法"><span class="toc-number">2.2.</span> <span class="toc-text">信息增益的定义与信息增益算法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-信息增益比"><span class="toc-number">3.</span> <span class="toc-text">3.信息增益比</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-ID3-：-最大信息增益"><span class="toc-number">4.</span> <span class="toc-text">4. ID3 ： 最大信息增益</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-C4-5-：最大信息增益率"><span class="toc-number">5.</span> <span class="toc-text">5. C4.5 ：最大信息增益率</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-CART-：最小基尼指数"><span class="toc-number">6.</span> <span class="toc-text">6.CART ：最小基尼指数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-分类树和回归树"><span class="toc-number">6.1.</span> <span class="toc-text">7.分类树和回归树</span></a></li></ol></li></ol></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png)"><div id="post-info"><div id="post-title"><div class="posttitle">机器学习系列之决策树算法（01）：决策树特征选择</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2019-12-17<span class="post-meta__separator">|</span><i class="fa fa-history" aria-hidden="true"></i> 更新于 2019-12-17</time><span class="post-meta__separator mobile_hidden">|</span><span class="mobile_hidden"><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/MachineLearning/">MachineLearning</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/MachineLearning/DecisionTree/">DecisionTree</a></span><div class="post-meta-wordcount"><i class="fa fa-file-word-o post-meta__icon" aria-hidden="true"></i><span>字数总计: </span><span class="word-count">3.2k</span><span class="post-meta__separator">|</span><i class="fa fa-clock-o post-meta__icon" aria-hidden="true"></i><span>阅读时长: 9 分钟</span><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true">       </i><span>阅读量: </span><span id="busuanzi_value_page_pv"></span></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h2 id="1-什么是特征选择"><a href="#1-什么是特征选择" class="headerlink" title="1.什么是特征选择"></a>1.什么是特征选择</h2><p>【特征选择】顾名思义就是对特征进行选择，以达到提高决策树学习的效率的目的。</p>
<p>【那么选择的是什么样的特征呢？】这里我们选择的特征需要是<strong>对训练数据有分类能力</strong>的特征，如果一个特征参与分类与否和随机分类的结果差别不大的话，我们就说这个特征<strong>没有分类能力</strong>，舍去这个特征对学习的精度不会有特别大的影响。</p>
<blockquote>
<p>特征选择是决定用哪个特征来划分特征空间。</p>
</blockquote>
<p>比如女生找男朋友，可能这个女生<strong>首先</strong>会问「这个男生帅不帅」，其次再是「身高如何」、「有无房子」、「收入区间」、「做什么工作」等等，那么「帅否」这个特征就是这位女生心中有着最好分类能力的特征了</p>
<p>【那怎么判断哪个特征有更好的分类能力呢？】这时候【<strong>信息增益</strong>】就要出场了。</p>
<h2 id="2-信息增益"><a href="#2-信息增益" class="headerlink" title="2.信息增益"></a>2.信息增益</h2><p>为了解释什么是信息增益，我们首先要讲解一下什么是【<strong>熵（entropy）</strong>】</p>
<h3 id="熵（Entropy）"><a href="#熵（Entropy）" class="headerlink" title="熵（Entropy）"></a><strong>熵（Entropy）</strong></h3><blockquote>
<p>在热力学与化学中：</p>
<p>熵是一种测量在动力学方面【<strong>不能做功的能量的总数</strong>】，当总体熵增加，其<strong>做功能力</strong>也下降，熵的度量是<strong>能量退化</strong>的指标。</p>
</blockquote>
<p>1948 年，香农把热力学中的熵引入到信息论中，称为<strong>香农熵</strong>。根据维基百科的描述：</p>
<blockquote>
<p>在信息论中，熵是接收的<strong>每条消息</strong>中包含的<strong>信息的平均量</strong>。</p>
</blockquote>
<p>更一般的，【<strong>熵表示随机变量的不确定性</strong>】。假设一个有限取值的离散随机变量 X 的概率分布如下：</p>
<p><img alt="[公式]" data-src="https://www.zhihu.com/equation?tex=P%28X+%3D+x_i%29+%3D+p_i%2C%5C+%5C+%5C+%5C+i+%3D+1%2C+2%2C+%5Ccdots%2C+n" class="lazyload"></p>
<p>那么它的熵定义为：</p>
<p><img alt="[公式]" data-src="https://www.zhihu.com/equation?tex=H%28X%29+%3D+-%5Csum_%7Bi%3D1%7D%5En+p_i+%5Clog_%7Bb%7D+p_i" class="lazyload"></p>
<p>上式中的 b 通常取 2 或者自然对数 <em>e</em>，这时熵的单位就分别称为比特（bit）或纳特（nat），这也是信息论中，信息量的单位。</p>
<p>从上式中，我们可以看到，<strong>熵与 X 的取值是没有关系的，它只与 X 的分布有关</strong>，所以 H 也可以写作 p 的函数：</p>
<p><img alt="[公式]" data-src="https://www.zhihu.com/equation?tex=H%28p%29+%3D+-%5Csum_%7Bi%3D1%7D%5En+p_i%5Clog+p_i" class="lazyload"></p>
<p>我们现在来看两个随机变量的情况。</p>
<p>假设随机变量 (X, Y) 的联合概率分布如下：</p>
<p><img alt="[公式]" data-src="https://www.zhihu.com/equation?tex=P%28X+%3D+x_i%2C+Y+%3D+y_j%29+%3D+p_%7Bij%7D%2C%5C+%5C+%5C+%5C+i+%3D+1%2C+2%2C+%5Ccdots%2C+n%3B%5C+j+%3D+1%2C+2%2C+%5Ccdots%2C+m" class="lazyload"></p>
<p>我们使用<strong>条件熵（conditional entropy）H(Y|X)</strong>来度量在已知随机变量 X 的条件下随机变量 Y 的不确定性。</p>
<blockquote>
<p>条件熵定义为：X 给定条件下，Y 的条件概率分布的熵对 X 的数学期望。</p>
</blockquote>
<p>是不是看晕了，没关系，我们来看数学公式，这才是最简单直接让你晕过去的方法：</p>
<p><img alt="[公式]" data-src="https://www.zhihu.com/equation?tex=H%28Y%7CX%29+%3D+%5Csum_%7Bi%3D1%7D%5En+p_i+H%28Y%7CX%3Dx_i%29%2C%5C+%5C+%5C+%5C+p_i+%3D+P%28X%3Dx_i%29%2C%5C+i+%3D+1%2C+2%2C+%5Ccdots%2C+n" class="lazyload"></p>
<p>有了上面的公式以后，条件熵的定义就非常容易理解了。</p>
<p>那么这些奇奇怪怪的熵又和我们要讲的信息增益有什么关系呢？</p>
<h3 id="信息增益的定义与信息增益算法"><a href="#信息增益的定义与信息增益算法" class="headerlink" title="信息增益的定义与信息增益算法"></a>信息增益的定义与信息增益算法</h3><p>既然熵是信息量的一种度量，那么信息增益就是熵的增加咯？</p>
<p>没错，由于熵表示不确定性，严格来说，<strong>信息增益（information gain）表示的是「得知了特征 X 的信息之后，类别 Y 的信息的不确定性减少的程度」</strong>。</p>
<p>我们给出信息增益的最终定义：</p>
<blockquote>
<p>特征 A 对训练数据集 D 的信息增益 g(D, A)，定义为，集合 D 的经验熵 H(D) 与特征 A 给定条件下 D 的经验条件熵 H(D|A) 之差。</p>
</blockquote>
<p><img alt="[公式]" data-src="https://www.zhihu.com/equation?tex=g%28D%2C+A%29+%3D+H%28D%29+-+H%28D%7CA%29" class="lazyload"></p>
<p><em>这里你只要知道经验熵和经验条件熵就是依据经验（由数据估计特别是极大似然估计）得出来的熵就可以了。</em></p>
<p>假设我们有一个训练集 D 和一个特征 A，那么，经验熵 H(D) 就是对 D 进行分类的不确定性，经验条件熵 H(D|A) 就是给定 A 后，对 D 分类的不确定性，经验熵 H(D) 与经验条件熵 H(D|A) 的差就是信息增益。</p>
<p>很明显的，不同的特征有不同的信息增益，信息增益大的特征分类能力更强。我们就是要根据信息增益来选择特征。</p>
<blockquote>
<p><strong>ps：信息增益体现了特征的重要性，信息增益越大说明特征越重要</strong></p>
<p><strong>信息熵体现了信息的不确定程度，熵越大表示特征越不稳定，对于此次的分类，越大表示类别之间的数据差别越大</strong></p>
<p><strong>条件熵体现了根据该特征分类后的不确定程度，越小说明分类后越稳定</strong></p>
<p><strong>信息增益=信息熵-条件熵，越大说明熵的变化越大，熵的变化越大越有利于分类</strong></p>
</blockquote>
<p>下面我们给出信息增益的算法。</p>
<p>首先对数据做一些介绍：</p>
<ul>
<li>假设我们有一个训练集 D，训练集的总的样本个数即样本容量为 |D|，最后的结果有 K 个类别，每个类别表示为 <img alt="[公式]" data-src="https://www.zhihu.com/equation?tex=C_k" class="lazyload"> ， <img alt="[公式]" data-src="https://www.zhihu.com/equation?tex=%7CC_k%7C" class="lazyload"> 为属于这个类的样本的个数，很显然 <img alt="[公式]" data-src="https://www.zhihu.com/equation?tex=%5Csum_%7Bk%3D1%7D%5EK+%7CC_k%7C+%3D+%7CD%7C" class="lazyload"> 。</li>
<li>再假设我们有一个特征叫 A，A 有 n 个不同的取值 <img alt="[公式]" data-src="https://www.zhihu.com/equation?tex=%5C%7Ba_1%2C+a_2%2C+%5Ccdots%2C+a_n%5C%7D" class="lazyload"> ，那么根据 A 我们可以将 D 分成 n 个子集，每个子集表示为 <img alt="[公式]" data-src="https://www.zhihu.com/equation?tex=D_i" class="lazyload"> ， <img alt="[公式]" data-src="https://www.zhihu.com/equation?tex=%7CD_i%7C" class="lazyload"> 是这个子集的样本个数，很显然 <img alt="[公式]" data-src="https://www.zhihu.com/equation?tex=%5Csum_%7Bi%3D1%7D%5En+%7CD_i%7C+%3D+%7CD%7C" class="lazyload"> 。</li>
<li>我们把 <img alt="[公式]" data-src="https://www.zhihu.com/equation?tex=D_i" class="lazyload"> 中属于类别 <img alt="[公式]" data-src="https://www.zhihu.com/equation?tex=C_k" class="lazyload"> 的集合称作 <img alt="[公式]" data-src="https://www.zhihu.com/equation?tex=D_%7Bik%7D%2C%5C+D_%7Bik%7D+%3D+D_i+%5Cbigcap+C_k" class="lazyload"> ， <img alt="[公式]" data-src="https://www.zhihu.com/equation?tex=%7CD_%7Bik%7D%7C" class="lazyload"> 是其样本个数。</li>
</ul>
<p>信息增益的计算就分为如下几个步骤：</p>
<ol>
<li>计算 D 的经验熵 H(D)：</li>
</ol>
<p><img alt="[公式]" data-src="https://www.zhihu.com/equation?tex=H%28D%29+%3D+-%5Csum_%7Bk%3D1%7D%5EK+%5Cfrac%7B%7CC_k%7C%7D%7B%7CD%7C%7D+%5Clog_2+%5Cfrac%7B%7CC_k%7C%7D%7B%7CD%7C%7D" class="lazyload"></p>
<p>\2. 计算 A 对 D 的经验条件熵 H(D|A)：</p>
<p><img alt="[公式]" data-src="https://www.zhihu.com/equation?tex=H%28D%7CA%29+%3D+%5Csum_%7Bi%3D1%7D%5En+%5Cfrac%7B%7CD_i%7C%7D%7B%7CD%7C%7D+H%28D_i%29+%3D+-+%5Csum_%7Bi%3D1%7D%5En+%5Cfrac%7B%7CD_i%7C%7D%7B%7CD%7C%7D+%5Csum_%7Bk%3D1%7D%5EK+%5Cfrac%7B%7CD_%7Bik%7D%7C%7D%7B%7CD_i%7C%7D+%5Clog_2+%5Cfrac%7B%7CD_%7Bik%7D%7C%7D%7B%7CD_i%7C%7D" class="lazyload"></p>
<p>\3. 计算信息增益 g(D, A)：</p>
<p><img alt="[公式]" data-src="https://www.zhihu.com/equation?tex=g%28D%2C+A%29+%3D+H%28D%29+-+H%28D%7CA%29" class="lazyload"></p>
<h2 id="3-信息增益比"><a href="#3-信息增益比" class="headerlink" title="3.信息增益比"></a>3.信息增益比</h2><p>看到这个小标题，可能有人会问，信息增益我知道了，信息增益比又是个什么玩意儿？</p>
<p>按照经验来看，【<strong>以信息增益准则来选择划分数据集的特征，其实倾向于选择有更多取值的特征，而有时这种倾向会在决策树的构造时带来一定的误差</strong>】。</p>
<p><strong>ps：信息增益体现了特征的重要性，信息增益越大说明特征越重要。</strong>类别越多代表特征越不确定，即熵越多，类别的信息增益越小。</p>
<p>为了校正这一误差，我们引入了【<strong>信息增益比（information gain ratio）</strong>】，又叫做信息增益率，它的定义如下：</p>
<p>特征 A 对训练数据集 D 的信息增益比 <img alt="[公式]" data-src="https://www.zhihu.com/equation?tex=g_R%28D%2C+A%29" class="lazyload"> 定义为其信息增益 <img alt="[公式]" data-src="https://www.zhihu.com/equation?tex=g%28D%2C+A%29" class="lazyload"> 与训练数据集 D 关于特征 A 的值的熵 <img alt="[公式]" data-src="https://www.zhihu.com/equation?tex=H_A%28D%29" class="lazyload"> 之比。</p>
<p><img alt="[公式]" data-src="https://www.zhihu.com/equation?tex=g_R%28D%2C+A%29+%3D+%5Cfrac%7Bg%28D%2C+A%29%7D%7BH_A%28D%29%7D" class="lazyload"></p>
<p>其中， <img alt="[公式]" data-src="https://www.zhihu.com/equation?tex=H_A%28D%29+%3D+-%5Csum_%7Bi%3D1%7D%5En+%5Cfrac%7B%7CD_i%7C%7D%7B%7CD%7C%7D+%5Clog_2+%5Cfrac%7B%7CD_i%7C%7D%7B%7CD%7C%7D" class="lazyload"> ，n 是 A 取值的个数。</p>
<p>两个经典的决策树算法 ID3 算法和 C4.5 算法，分别会采用信息增益和信息增益比作为特征选择的依据。</p>
<h2 id="4-ID3-：-最大信息增益"><a href="#4-ID3-：-最大信息增益" class="headerlink" title="4. ID3 ： 最大信息增益"></a>4. ID3 ： 最大信息增益</h2><blockquote>
<p>ID3以信息增益为准则来选择最优划分属性</p>
</blockquote>
<p>信息增益的计算要基于信息熵（度量样本集合纯度的指标）</p>
<p><img alt="img" data-src="https://pic2.zhimg.com/80/v2-e0ce667594401d2f8daf3ee6a7da9151_hd.jpg" class="lazyload">信息熵越小，数据集X的纯度越大</p>
<p>因此，假设于数据集D上建立决策树，数据有K个类别：</p>
<p><img alt="img" data-src="https://pic1.zhimg.com/80/v2-f6d10699fdbe216617836c7e8732ba58_hd.jpg" class="lazyload"></p>
<p>公式（1）中：</p>
<p><img alt="img" data-src="https://pic2.zhimg.com/80/v2-181bbc695d6de40eff56d86518d84f29_hd.jpg" class="lazyload">表示第k类样本的数据占数据集D样本总数的比例</p>
<p>公式（2）表示的是以特征A作为分割的属性，得到的信息熵：</p>
<p>Di表示的是以属性A为划分，分成n个分支，第i个分支的节点集合</p>
<p>因此，该公式求的是以属性A为划分，n个分支的信息熵总和</p>
<p>公式（3）为分割后与分割前的信息熵的差值，也就是信息增益，越大越好</p>
<p>但是这种分割算法存在一定的<strong>缺陷</strong>：</p>
<blockquote>
<p>假设每个记录有一个属性“ID”，若按照ID来进行分割的话，由于ID是唯一的，因此在这一个属性上，能够取得的特征值等于样本的数目，也就是说ID的特征值很多。那么无论以哪个ID为划分，叶子结点的值只会有一个，纯度很大，得到的信息增益会很大，但这样划分出来的决策树是没意义的。由此可见，<strong>ID3决策树偏向于取值较多的属性进行分割，存在一定的偏好。</strong>为减小这一影响，有学者提出C4.5的分类算法。</p>
</blockquote>
<h2 id="5-C4-5-：最大信息增益率"><a href="#5-C4-5-：最大信息增益率" class="headerlink" title="5. C4.5 ：最大信息增益率"></a>5. C4.5 ：<strong>最大信息增益率</strong></h2><blockquote>
<p>C4.5基于信息增益率准则选择最优分割属性的算法</p>
</blockquote>
<p>信息增益比率通过引入一个被称作【<strong>分裂信息(Split information)</strong>】的项来惩罚取值较多的属性。</p>
<p><img alt="img" data-src="https://pic2.zhimg.com/80/v2-c35719627c479737cb680c3f4d8cdf6d_hd.jpg" class="lazyload"></p>
<p>上式，<strong>分子计算与ID3一样，分母是由属性A的特征值个数决定的，个数越多，IV值越大，信息增益率越小，这样就可以避免模型偏好特征值多的属性，但是聪明的人一看就会发现，如果简单的按照这个规则来分割，模型又会偏向特征数少的特征</strong>。因此C4.5决策树先从候选划分属性中找出<strong>信息增益高于平均水平</strong>的属性，在从中选择<strong>增益率最高</strong>的。</p>
<p>对于连续值属性来说，可取值数目不再有限，因此可以采用<strong>离散化技术</strong>（如二分法）进行处理。将属性值从小到大排序，然后选择中间值作为分割点，数值比它小的点被划分到左子树，数值不小于它的点被分到又子树，计算分割的信息增益率，选择信息增益率最大的属性值进行分割。</p>
<h2 id="6-CART-：最小基尼指数"><a href="#6-CART-：最小基尼指数" class="headerlink" title="6.CART ：最小基尼指数"></a>6.CART ：<strong>最小基尼指数</strong></h2><blockquote>
<p>CART以基尼系数为准则选择最优划分属性，可以应用于分类和回归</p>
</blockquote>
<p>CART是一棵<strong>二叉树</strong>，采用【<strong>二元切分法</strong>】，每次把数据切成两份，分别进入左子树、右子树。而且每个非叶子节点都有两个孩子，所以CART的叶子节点比非叶子多1。相比ID3和C4.5，CART应用要多一些，<strong>既可以用于分类也可以用于回归</strong>。CART分类时，使用<strong>基尼指数（Gini）</strong>来选择最好的数据分割的特征，gini描述的是纯度，与信息熵的含义相似。<strong>CART中每一次迭代都会降低GINI系数。</strong></p>
<p><img alt="img" data-src="https://pic3.zhimg.com/80/v2-79214da261d75829046953ab9cb8b03a_hd.jpg" class="lazyload">Di表示以A是属性值划分成n个分支里的数目</p>
<p>Gini(D)反映了数据集D的纯度，值越小，纯度越高。我们在候选集合中选择使得划分后<strong>基尼指数最小的属性作为最优化分属性。</strong></p>
<h3 id="7-分类树和回归树"><a href="#7-分类树和回归树" class="headerlink" title="7.分类树和回归树"></a>7.<strong>分类树和回归树</strong></h3><p>提到决策树算法，很多想到的就是上面提到的ID3、C4.5、CART分类决策树。其实决策树分为分类树和回归树，前者用于分类，如晴天/阴天/雨天、用户性别、邮件是否是垃圾邮件，后者用于预测实数值，如明天的温度、用户的年龄等。</p>
<p>作为对比，先说分类树，我们知道ID3、C4.5分类树在每次分枝时，是穷举每一个特征属性的每一个阈值，找到使得按照feature&lt;=阈值，和feature&gt;阈值分成的两个分枝的熵最大的feature和阈值。按照该标准分枝得到两个新节点，用同样方法继续分枝直到所有人都被分入性别唯一的叶子节点，或达到预设的终止条件，若最终叶子节点中的性别不唯一，则以多数人的性别作为该叶子节点的性别。</p>
<p>回归树总体流程也是类似，不过在每个节点（不一定是叶子节点）都会得一个预测值，以年龄为例，该预测值等于属于这个节点的所有人年龄的平均值。分枝时穷举每一个feature的每个阈值找最好的分割点，但衡量最好的标准不再是最大熵，而是最小化均方差–即（每个人的年龄-预测年龄）^2 的总和 / N，或者说是每个人的预测误差平方和 除以 N。这很好理解，被预测出错的人数越多，错的越离谱，均方差就越大，通过最小化均方差能够找到最靠谱的分枝依据。分枝直到每个叶子节点上人的年龄都唯一（这太难了）或者达到预设的终止条件（如叶子个数上限），若最终叶子节点上人的年龄不唯一，则以该节点上所有人的平均年龄做为该叶子节点的预测年龄。</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined" target="_blank" rel="noopener">Leon</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://dataquaner.github.io/2019/12/17/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%B3%BB%E5%88%97%E4%B9%8B%E5%86%B3%E7%AD%96%E6%A0%91%E7%AE%97%E6%B3%95%EF%BC%8801%EF%BC%89%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E7%89%B9%E5%BE%81%E9%80%89%E6%8B%A9/">https://dataquaner.github.io/2019/12/17/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%B3%BB%E5%88%97%E4%B9%8B%E5%86%B3%E7%AD%96%E6%A0%91%E7%AE%97%E6%B3%95%EF%BC%8801%EF%BC%89%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E7%89%B9%E5%BE%81%E9%80%89%E6%8B%A9/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://dataquaner.github.io">DataQuaner</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%86%B3%E7%AD%96%E6%A0%91/">决策树    </a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button"><i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.jpg"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg"><div class="post-qr-code__desc">支付宝</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2019/12/17/%E6%9E%81%E5%AE%A2%E6%97%B6%E9%97%B4%E3%80%8A%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%9045%E8%AE%B2%E6%80%BB%E7%BB%93%E3%80%8B/"><img class="prev_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>极客时间《数据分析45讲总结》</span></div></a></div><div class="next-post pull_right"><a href="/2019/12/16/xgboost%E7%AE%97%E6%A8%A1%E5%9E%8B%E8%BE%93%E5%87%BA%E7%9A%84%E8%A7%A3%E9%87%8A/"><img class="next_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>xgboost算法模型输出的解释</span></div></a></div></nav><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div id="disqus_thread"></div><script>var unused = null;
var disqus_config = function () {
  this.page.url = 'https://dataquaner.github.io/2019/12/17/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%B3%BB%E5%88%97%E4%B9%8B%E5%86%B3%E7%AD%96%E6%A0%91%E7%AE%97%E6%B3%95%EF%BC%8801%EF%BC%89%EF%BC%9A%E5%86%B3%E7%AD%96%E6%A0%91%E7%89%B9%E5%BE%81%E9%80%89%E6%8B%A9/';
  this.page.identifier = '2019/12/17/机器学习系列之决策树算法（01）：决策树特征选择/';
  this.page.title = '机器学习系列之决策树算法（01）：决策树特征选择';
}
var d = document, s = d.createElement('script');
s.src = "https://" + 'dataquaner' +".disqus.com/embed.js";
s.setAttribute('data-timestamp', '' + +new Date());
(d.head || d.body).appendChild(s);</script></div></div></div><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2019 By Leon</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="footer_custom_text">Hi, welcome to my <a href="https://dataquaner.github.io/">blog</a>!</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="/js/baidupush.js"> </script><script src="/js/tw_cn.js"></script><script>translateInitilization()
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script></body></html>