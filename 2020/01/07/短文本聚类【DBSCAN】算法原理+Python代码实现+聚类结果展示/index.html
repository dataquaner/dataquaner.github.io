<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>短文本聚类【DBSCAN】算法原理+Python代码实现+聚类结果展示 | DataQuaner</title><meta name="description" content="DBSCAN"><meta name="keywords" content="DBSCAN"><meta name="author" content="Leon"><meta name="copyright" content="Leon"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="短文本聚类【DBSCAN】算法原理+Python代码实现+聚类结果展示"><meta name="twitter:description" content="DBSCAN"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png"><meta property="og:type" content="article"><meta property="og:title" content="短文本聚类【DBSCAN】算法原理+Python代码实现+聚类结果展示"><meta property="og:url" content="https://dataquaner.github.io/2020/01/07/%E7%9F%AD%E6%96%87%E6%9C%AC%E8%81%9A%E7%B1%BB%E3%80%90DBSCAN%E3%80%91%E7%AE%97%E6%B3%95%E5%8E%9F%E7%90%86+Python%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0+%E8%81%9A%E7%B1%BB%E7%BB%93%E6%9E%9C%E5%B1%95%E7%A4%BA/"><meta property="og:site_name" content="DataQuaner"><meta property="og:description" content="DBSCAN"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://dataquaner.github.io/2020/01/07/%E7%9F%AD%E6%96%87%E6%9C%AC%E8%81%9A%E7%B1%BB%E3%80%90DBSCAN%E3%80%91%E7%AE%97%E6%B3%95%E5%8E%9F%E7%90%86+Python%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0+%E8%81%9A%E7%B1%BB%E7%BB%93%E6%9E%9C%E5%B1%95%E7%A4%BA/"><link rel="prev" title="DBSCAN算法python实现（附完整数据集和代码）" href="https://dataquaner.github.io/2020/01/07/DBSCAN%E7%AE%97%E6%B3%95python%E5%AE%9E%E7%8E%B0%EF%BC%88%E9%99%84%E5%AE%8C%E6%95%B4%E6%95%B0%E6%8D%AE%E9%9B%86%E5%92%8C%E4%BB%A3%E7%A0%81%EF%BC%89/"><link rel="next" title="机器学习系列之决策树算法(08):梯度提升树算法LightGBM" href="https://dataquaner.github.io/2020/01/07/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%B3%BB%E5%88%97%E4%B9%8B%E5%86%B3%E7%AD%96%E6%A0%91%E7%AE%97%E6%B3%95%EF%BC%8808%EF%BC%89%EF%BC%9A%E6%A2%AF%E5%BA%A6%E6%8F%90%E5%8D%87%E6%A0%91%E7%AE%97%E6%B3%95LightGBM/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  highlight_copy: 'true',
  highlight_lang: 'true',
  highlight_shrink: 'false',
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  copyright: undefined,
  copy_copyright_js: false,
  ClickShowText: undefined,
  medium_zoom: 'false',
  Snackbar: undefined
  
}</script><link rel="alternate" href="/atom.xml" title="DataQuaner" type="application/atom+xml">
</head><body><div id="header"> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">DataQuaner</a></span><i class="fa fa-bars fa-fw toggle-menu pull_right close" aria-hidden="true"></i><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 类别</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 小憩</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li></ul></div></div></span><span class="pull_right" id="search_button"></span></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="lazyload avatar_img" src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/Photo/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'"></div><div class="mobile_post_data"><div class="mobile_data_item is_center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">15</div></a></div></div><div class="mobile_data_item is_center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">7</div></a></div></div><div class="mobile_data_item is_center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">10</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 类别</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 小憩</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li></ul></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#目录"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">目录</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#1-算法原理"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text">1. 算法原理</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#1-1-常见的聚类算法"><span class="toc_mobile_items-number">2.1.</span> <span class="toc_mobile_items-text">1.1 常见的聚类算法</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#1-2-DBSCAN聚类"><span class="toc_mobile_items-number">2.2.</span> <span class="toc_mobile_items-text">1.2 DBSCAN聚类</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#2-代码实现"><span class="toc_mobile_items-number">3.</span> <span class="toc_mobile_items-text">2. 代码实现</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-1-import需要的包"><span class="toc_mobile_items-number">3.1.</span> <span class="toc_mobile_items-text">2.1 import需要的包</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-2-载入数据"><span class="toc_mobile_items-number">3.2.</span> <span class="toc_mobile_items-text">2.2 载入数据</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-3-对文本进行分词，并记录词性"><span class="toc_mobile_items-number">3.3.</span> <span class="toc_mobile_items-text">2.3 对文本进行分词，并记录词性</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-4-文本向量化–TF-IDF权重"><span class="toc_mobile_items-number">3.4.</span> <span class="toc_mobile_items-text">2.4 文本向量化–TF-IDF权重</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-5-基于词性的新权重"><span class="toc_mobile_items-number">3.5.</span> <span class="toc_mobile_items-text">2.5 基于词性的新权重</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-6-DBSCAN模型"><span class="toc_mobile_items-number">3.6.</span> <span class="toc_mobile_items-text">2.6 DBSCAN模型</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#3-聚类结果"><span class="toc_mobile_items-number">4.</span> <span class="toc_mobile_items-text">3. 聚类结果</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#4-附件：完整代码"><span class="toc_mobile_items-number">5.</span> <span class="toc_mobile_items-text">4 附件：完整代码</span></a></li></ol></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#目录"><span class="toc-number">1.</span> <span class="toc-text">目录</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-算法原理"><span class="toc-number">2.</span> <span class="toc-text">1. 算法原理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-常见的聚类算法"><span class="toc-number">2.1.</span> <span class="toc-text">1.1 常见的聚类算法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-DBSCAN聚类"><span class="toc-number">2.2.</span> <span class="toc-text">1.2 DBSCAN聚类</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-代码实现"><span class="toc-number">3.</span> <span class="toc-text">2. 代码实现</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-import需要的包"><span class="toc-number">3.1.</span> <span class="toc-text">2.1 import需要的包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-载入数据"><span class="toc-number">3.2.</span> <span class="toc-text">2.2 载入数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-对文本进行分词，并记录词性"><span class="toc-number">3.3.</span> <span class="toc-text">2.3 对文本进行分词，并记录词性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4-文本向量化–TF-IDF权重"><span class="toc-number">3.4.</span> <span class="toc-text">2.4 文本向量化–TF-IDF权重</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-5-基于词性的新权重"><span class="toc-number">3.5.</span> <span class="toc-text">2.5 基于词性的新权重</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-6-DBSCAN模型"><span class="toc-number">3.6.</span> <span class="toc-text">2.6 DBSCAN模型</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-聚类结果"><span class="toc-number">4.</span> <span class="toc-text">3. 聚类结果</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-附件：完整代码"><span class="toc-number">5.</span> <span class="toc-text">4 附件：完整代码</span></a></li></ol></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png)"><div id="post-info"><div id="post-title"><div class="posttitle">短文本聚类【DBSCAN】算法原理+Python代码实现+聚类结果展示</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2020-01-07<span class="post-meta__separator">|</span><i class="fa fa-history" aria-hidden="true"></i> 更新于 2020-01-07</time><span class="post-meta__separator mobile_hidden">|</span><span class="mobile_hidden"><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Machine-Learning/">Machine Learning</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Machine-Learning/DBSCAN/">DBSCAN</a></span><div class="post-meta-wordcount"><i class="fa fa-file-word-o post-meta__icon" aria-hidden="true"></i><span>字数总计: </span><span class="word-count">2.6k</span><span class="post-meta__separator">|</span><i class="fa fa-clock-o post-meta__icon" aria-hidden="true"></i><span>阅读时长: 10 分钟</span><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true">       </i><span>阅读量: </span><span id="busuanzi_value_page_pv"></span></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h1 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h1><p>[TOC]</p>
<h1 id="1-算法原理"><a href="#1-算法原理" class="headerlink" title="1. 算法原理"></a>1. 算法原理</h1><h2 id="1-1-常见的聚类算法"><a href="#1-1-常见的聚类算法" class="headerlink" title="1.1 常见的聚类算法"></a>1.1 常见的聚类算法</h2><p>聚类算法属于常见的无监督分类算法，在很多场景下都有应用，如用户聚类，文本聚类等。常见的聚类算法可以分成两类：</p>
<ul>
<li>以 k-means 为代表的基于分区的算法</li>
<li>以层次聚类为代表的基于层次划分的算法</li>
</ul>
<p>对于第一类方法，有以下几个缺点：</p>
<blockquote>
<p>1）需要事先确定聚类的个数，当数据集比较大时，很难事先给出一个合适的值；</p>
<p>2）只适用于具有凸形状的簇，不适用于具有任意形状的簇；</p>
<p>3）对内存的占用资源比较大，难以推广至大规模数据集；        </p>
</blockquote>
<p>对于第二类方法，有以下缺点：</p>
<blockquote>
<p>1）需要确定停止分裂的条件</p>
<p>2）计算速度慢</p>
</blockquote>
<h2 id="1-2-DBSCAN聚类"><a href="#1-2-DBSCAN聚类" class="headerlink" title="1.2 DBSCAN聚类"></a>1.2 DBSCAN聚类</h2><blockquote>
<p><a href="http://www.philippe-fournier-viger.com/spmf/DBScan.pdf" target="_blank" rel="noopener">A Density-Based Algorithm for Discovering Clusters in Large Spatial Databases with Noise （Martin Ester, Hans-Peter Kriegel, Jörg Sander, Xiaowei Xu）</a></p>
</blockquote>
<p>DBSCAN是一类基于密度的算法，能有效解决上述两类算法的问题。</p>
<blockquote>
<p>DBSCAN的基本假设是一个集群的密度要显著高于噪声点的密度。因此，其基本思想是对于集群中的每一个点，在给定的半径范围内，相邻点的数量必须超过预先设定的某一个阈值。</p>
</blockquote>
<p>因此，DBSCAN算法中包含两个重要的参数：</p>
<blockquote>
<p><strong>eps：</strong>聚类类别中样本的相似度衡量，与类别内样本相似度成反比。可以理解为同一个类别当中，对两个样本之间距离的最大值限定。<br>    <strong>min_samples：</strong>每个聚类类别中的最小样本数，会对未分类样本数量造成影响，与未分类样本数量成正比。当相似样本数量少于该参数时，不会聚到一起。</p>
</blockquote>
<p>在实际应用过程中，根据样本的大小，以及样本的大致分布，了解聚类结果会随着这两个参数如何变化之后，可以根据自己的经验对两个参数进行调整。只有两个模型参数需要调整，因此调参过程也不会太麻烦。</p>
<h1 id="2-代码实现"><a href="#2-代码实现" class="headerlink" title="2. 代码实现"></a>2. 代码实现</h1><h2 id="2-1-import需要的包"><a href="#2-1-import需要的包" class="headerlink" title="2.1 import需要的包"></a>2.1 import需要的包</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># === import packages === #</span></span><br><span class="line"><span class="keyword">import</span> jieba.posseg <span class="keyword">as</span> pseg</span><br><span class="line"><span class="keyword">from</span> sklearn.feature_extraction.text <span class="keyword">import</span> TfidfTransformer</span><br><span class="line"><span class="keyword">from</span> sklearn.feature_extraction.text <span class="keyword">import</span> CountVectorizer</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.cluster <span class="keyword">import</span> DBSCAN</span><br></pre></td></tr></table></figure>

<h2 id="2-2-载入数据"><a href="#2-2-载入数据" class="headerlink" title="2.2 载入数据"></a>2.2 载入数据</h2><p>根据数据文件的不同存在不同的数据载入方法，我当时使用的是两种类型的数据，分别是直接包含目标短文本的txt，以json格式存储的txt。如果有用到这两种类型的文件可以参考这部分的数据载入代码，其他的请根据文件类型和数据样式自行载入。首先是载入以json格式存储的txt文件，可以用正则表达式，也可以根据数据存储的方式提取出对应的字段。先展示一下数据的存储格式：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="attr">"code"</span>: <span class="string">"200"</span>,</span><br><span class="line"><span class="attr">"data"</span>: &#123;</span><br><span class="line"><span class="attr">"result"</span>: [</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">"updateDate"</span>: <span class="number">1551923786433</span>,</span><br><span class="line"><span class="attr">"ensureIntentName"</span>: <span class="string">"新意图"</span>,</span><br><span class="line"><span class="attr">"corpus"</span>: <span class="string">"怎么查询之前的小微提醒"</span>,</span><br><span class="line"><span class="attr">"recommendResult"</span>: <span class="number">0</span>,</span><br><span class="line"><span class="attr">"remark"</span>: <span class="string">""</span>,</span><br><span class="line"><span class="attr">"source"</span>: <span class="number">2</span>,</span><br><span class="line"><span class="attr">"result"</span>: <span class="number">2</span>,</span><br><span class="line"><span class="attr">"eventName"</span>: <span class="string">""</span>,</span><br><span class="line"><span class="attr">"id"</span>: <span class="string">"b07328fc-8383-44b7-b466-15b063b8544a"</span>,</span><br><span class="line"><span class="attr">"state"</span>: <span class="number">0</span>,</span><br><span class="line"><span class="attr">"tag"</span>: <span class="string">""</span>,</span><br><span class="line"><span class="attr">"isHandle"</span>: <span class="number">1</span>,</span><br><span class="line"><span class="attr">"createDate"</span>: <span class="number">1551669751334</span>,</span><br><span class="line"><span class="attr">"eventId"</span>: <span class="string">""</span>,</span><br><span class="line"><span class="attr">"corpusTagId"</span>: <span class="string">"3335d2d8-a16e-46a2-9ed7-76739108d684"</span>,</span><br><span class="line"><span class="attr">"intentName"</span>: <span class="string">""</span>,</span><br><span class="line"><span class="attr">"ensureIntent"</span>: <span class="string">"newIntent"</span>,</span><br><span class="line"><span class="attr">"recommendIntent"</span>: [</span><br><span class="line"><span class="string">"setmsgnotifications"</span></span><br><span class="line">],</span><br><span class="line"><span class="attr">"uploadTime"</span>: <span class="number">1551669751333</span>,</span><br><span class="line"><span class="attr">"w3account"</span>: <span class="string">"x00286769"</span>,</span><br><span class="line"><span class="attr">"createBy"</span>: <span class="string">"x00286769"</span>,</span><br><span class="line"><span class="attr">"intentCode"</span>: <span class="string">""</span>,</span><br><span class="line"><span class="attr">"isBotSupport"</span>: <span class="number">0</span>,</span><br><span class="line"><span class="attr">"userRole"</span>: <span class="string">"0"</span>,</span><br><span class="line"><span class="attr">"welinkVersion"</span>: <span class="string">"3.9.13"</span></span><br><span class="line">&#125;</span><br><span class="line">],</span><br><span class="line"><span class="attr">"pagination"</span>: &#123;</span><br><span class="line"><span class="attr">"pageCount"</span>: <span class="number">1</span>,</span><br><span class="line"><span class="attr">"pageSizes"</span>: <span class="number">50</span>,</span><br><span class="line"><span class="attr">"pageNumber"</span>: <span class="number">1</span>,</span><br><span class="line"><span class="attr">"offset"</span>: <span class="number">0</span>,</span><br><span class="line"><span class="attr">"pageTotal"</span>: <span class="number">1</span>,</span><br><span class="line"><span class="attr">"pageNumbers"</span>: <span class="number">1</span>,</span><br><span class="line"><span class="attr">"pageSize"</span>: <span class="number">50</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">"error"</span>: <span class="string">""</span>,</span><br><span class="line"><span class="attr">"stack"</span>: <span class="string">""</span>,</span><br><span class="line"><span class="attr">"message"</span>: <span class="string">"ok"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我的目标是对上述数据当中，字典中key “data” 对应的字典中的 “result” 中每一个item 的 “corpus” 进行提取，于是就有了下列代码。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># === Data loading === #</span></span><br><span class="line">data = []</span><br><span class="line">corpus = []</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> open(<span class="string">"新意图语料.txt"</span>, <span class="string">'r+'</span>, encoding=<span class="string">'UTF-8'</span>):</span><br><span class="line">    data.append(eval(line))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(data)):</span><br><span class="line">    tmp = data[i][<span class="string">'data'</span>][<span class="string">'result'</span>]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(len(tmp)):</span><br><span class="line">        corpus.append(tmp[j][<span class="string">'corpus'</span>])</span><br></pre></td></tr></table></figure>

<p>然后是载入包含目标短文本的txt，也就是说该txt直接存储了上面的 “corpus” 对应的内容，但是每一行的内容都加上了双引号和逗号，就通过strip把这些不需要的部分去掉了，最后得到所有 “corpus” 组成的list。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> open(<span class="string">"未识别语料.txt"</span>, <span class="string">'r+'</span>):</span><br><span class="line">    line = line.strip(<span class="string">'\n'</span>)</span><br><span class="line">    line = line.strip(<span class="string">'\t'</span>)</span><br><span class="line">    line = line.rstrip(<span class="string">','</span>)</span><br><span class="line">    line = line.lstrip(<span class="string">'"'</span>)</span><br><span class="line">    line = line.rstrip(<span class="string">'"'</span>)</span><br><span class="line">    corpus.append(line)</span><br></pre></td></tr></table></figure>

<h2 id="2-3-对文本进行分词，并记录词性"><a href="#2-3-对文本进行分词，并记录词性" class="headerlink" title="2.3 对文本进行分词，并记录词性"></a>2.3 对文本进行分词，并记录词性</h2><p>调用结巴词库对语料进行分词，并记录分词结果中每个词的词性。我的数据集在处理之后得到了5316条短文本，分词得到20640个不重复的词汇及其对应的词性，并建立了两者之间的字典联系。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># === Record the text cut and POS === #</span></span><br><span class="line">part_of_speech = []</span><br><span class="line">word_after_cut = []</span><br><span class="line">cut_corpus_iter = corpus.copy()</span><br><span class="line">cut_corpus = corpus.copy()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(corpus)):</span><br><span class="line">    cut_corpus_iter[i] = pseg.cut(corpus[i])  <span class="comment"># 5316</span></span><br><span class="line">    cut_corpus[i] = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> every <span class="keyword">in</span> cut_corpus_iter[i]:</span><br><span class="line">        cut_corpus[i] = (cut_corpus[i] + <span class="string">" "</span> + str(every.word)).strip()</span><br><span class="line">        part_of_speech.append(every.flag)  <span class="comment"># 20640</span></span><br><span class="line">        word_after_cut.append(every.word)  <span class="comment"># 20640</span></span><br><span class="line">word_pos_dict = &#123;word_after_cut[i]: part_of_speech[i] <span class="keyword">for</span> i <span class="keyword">in</span> range(len(word_after_cut))&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-4-文本向量化–TF-IDF权重"><a href="#2-4-文本向量化–TF-IDF权重" class="headerlink" title="2.4 文本向量化–TF-IDF权重"></a>2.4 文本向量化–TF-IDF权重</h2><p>使用TF-IDF对文本进行向量化，得到文本的TF-IDF权重。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># === Get the TF-IDF weights === #</span></span><br><span class="line">Count_vectorizer = CountVectorizer()</span><br><span class="line">transformer = TfidfTransformer()  <span class="comment"># 用于统计每个词语的tf-idf权值</span></span><br><span class="line">tf_idf = transformer.fit_transform(Count_vectorizer.fit_transform(cut_corpus))</span><br><span class="line"><span class="comment"># （5316，2039）第一个fit_transform是计算tf-idf 第二个fit_transform是将文本转为词频矩阵</span></span><br><span class="line">word = Count_vectorizer.get_feature_names()  <span class="comment"># 2039，获取词袋模型中的所有词语</span></span><br><span class="line">weight = tf_idf.toarray()  <span class="comment"># （5316，2039）将tf-idf矩阵抽取出来，元素w[i][j]表示j词在i类文本中的tf-idf权重</span></span><br></pre></td></tr></table></figure>

<h2 id="2-5-基于词性的新权重"><a href="#2-5-基于词性的新权重" class="headerlink" title="2.5 基于词性的新权重"></a>2.5 基于词性的新权重</h2><p>前面得到了分词的结果，并对词性进行了记录，接下来可以针对不同词汇的词性码，给与其TF-IDF权重以不同的乘数，这样可以突出某些类型的词汇的重要性，在一定程度上有助于聚类的效果。</p>
<p>具体的乘数构造规则可以根据需求自行调整。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># === Get new weight with POS considered === #</span></span><br><span class="line">word_weight = [<span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(len(word))]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(word)):</span><br><span class="line">    <span class="keyword">if</span> word[i] <span class="keyword">not</span> <span class="keyword">in</span> word_pos_dict.keys():</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> word_pos_dict[word[i]] == <span class="string">'n'</span>:</span><br><span class="line">        word_weight[i] = <span class="number">1.2</span></span><br><span class="line">    <span class="keyword">elif</span> word_pos_dict[word[i]] == <span class="string">"vn"</span>:</span><br><span class="line">        word_weight[i] = <span class="number">1.1</span></span><br><span class="line">    <span class="keyword">elif</span> word_pos_dict[word[i]] == <span class="string">"m"</span>:</span><br><span class="line">        word_weight[i] = <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:  <span class="comment"># 权重调整可以根据实际情况进行更改</span></span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">word_weight = np.array(word_weight)</span><br><span class="line">new_weight = weight.copy()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(weight)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(len(word)):</span><br><span class="line">        new_weight[i][j] = weight[i][j] * word_weight[j]</span><br></pre></td></tr></table></figure>

<h2 id="2-6-DBSCAN模型"><a href="#2-6-DBSCAN模型" class="headerlink" title="2.6 DBSCAN模型"></a>2.6 DBSCAN模型</h2><p>得到了文本的向量化表示之后就可以将其投喂到模型当中了，eps和min_samples都是可以调整的参数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># === Fit the DBSCAN model and get the classify labels === #</span></span><br><span class="line">DBS_clf = DBSCAN(eps=<span class="number">1</span>, min_samples=<span class="number">4</span>)</span><br><span class="line">DBS_clf.fit(new_weight)</span><br><span class="line">print(DBS_clf.labels_)</span><br></pre></td></tr></table></figure>

<h1 id="3-聚类结果"><a href="#3-聚类结果" class="headerlink" title="3. 聚类结果"></a>3. 聚类结果</h1><p>DBSCAN模型实现聚类之后，聚类的结果会存储在 <code>labels_</code> 中，将 <code>labels_</code> 与原来的文本一一对应，可以得到最终的聚类结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># === Define the function of classify the original corpus according to the labels === #</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">labels_to_original</span><span class="params">(labels, original_corpus)</span>:</span></span><br><span class="line">    <span class="keyword">assert</span> len(labels) == len(original_corpus)</span><br><span class="line">    max_label = max(labels)</span><br><span class="line">    number_label = [i <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, max_label + <span class="number">1</span>, <span class="number">1</span>)]</span><br><span class="line">    number_label.append(<span class="number">-1</span>)</span><br><span class="line">    result = [[] <span class="keyword">for</span> i <span class="keyword">in</span> range(len(number_label))]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(labels)):</span><br><span class="line">        index = number_label.index(labels[i])</span><br><span class="line">        result[index].append(original_corpus[i])</span><br><span class="line">    <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">labels_original = labels_to_original(DBS_clf.labels_, corpus)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">	print(labels_original[i])</span><br><span class="line"><span class="comment"># 聚类结果展示（部分）	</span></span><br><span class="line">[<span class="string">'社保卡'</span>, <span class="string">'社保卡'</span>, <span class="string">'社保卡。'</span>, <span class="string">'社保卡办理'</span>, <span class="string">'社保卡'</span>, <span class="string">'社保卡'</span>, <span class="string">'社保卡挂失'</span>, <span class="string">'社保卡。'</span>, <span class="string">'社保卡'</span>, <span class="string">'领取社保卡。'</span>]</span><br><span class="line">[<span class="string">'五险一金'</span>, <span class="string">'五险一金。'</span>, <span class="string">'五险一金。'</span>, <span class="string">'五险一金介绍'</span>, <span class="string">'看看二月份五险一金情况'</span>]</span><br><span class="line">[<span class="string">'打开汇钱。'</span>, <span class="string">'打开汇钱。'</span>, <span class="string">'我要汇钱'</span>, <span class="string">'我要汇钱。'</span>, <span class="string">'我要汇钱。'</span>, <span class="string">'我要汇钱。'</span>, <span class="string">'我要汇钱。'</span>, <span class="string">'我要汇钱。'</span>, <span class="string">'我要汇钱。'</span>]</span><br><span class="line">[<span class="string">'车辆通行证。'</span>, <span class="string">'车辆通行证。'</span>, <span class="string">'我要办车辆通行证。'</span>, <span class="string">'车辆通行证'</span>, <span class="string">'车辆通行证'</span>, <span class="string">'车辆通行证'</span>, <span class="string">'车辆通行证'</span>, <span class="string">'车辆通行证。'</span>, <span class="string">'车辆通行证'</span>, <span class="string">'车辆通行证。'</span>, <span class="string">'车辆通行证。'</span>, <span class="string">'车辆通行证'</span>]</span><br><span class="line">[<span class="string">'邮件附件权限'</span>, <span class="string">'等等邮件附件权限。'</span>, <span class="string">'邮件附件权限'</span>, <span class="string">'邮件附件权限'</span>, <span class="string">'邮件附件权限'</span>, <span class="string">'邮件附件权限'</span>, <span class="string">'您好，请问怎样申请图片查看权限和邮件附件查看权限？'</span>]</span><br></pre></td></tr></table></figure>

<h1 id="4-附件：完整代码"><a href="#4-附件：完整代码" class="headerlink" title="4 附件：完整代码"></a>4 附件：完整代码</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># === import packages === #</span></span><br><span class="line"><span class="keyword">import</span> jieba.posseg <span class="keyword">as</span> pseg</span><br><span class="line"><span class="keyword">from</span> sklearn.feature_extraction.text <span class="keyword">import</span> TfidfTransformer</span><br><span class="line"><span class="keyword">from</span> sklearn.feature_extraction.text <span class="keyword">import</span> CountVectorizer</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.cluster <span class="keyword">import</span> DBSCAN</span><br><span class="line"></span><br><span class="line"><span class="comment"># === Data loading === #</span></span><br><span class="line">data = []</span><br><span class="line">corpus = []</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> open(<span class="string">"新意图语料.txt"</span>, <span class="string">'r+'</span>, encoding=<span class="string">'UTF-8'</span>):</span><br><span class="line">    data.append(eval(line))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(data)):</span><br><span class="line">    tmp = data[i][<span class="string">'data'</span>][<span class="string">'result'</span>]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(len(tmp)):</span><br><span class="line">        corpus.append(tmp[j][<span class="string">'corpus'</span>])</span><br><span class="line">        </span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> open(<span class="string">"未识别语料.txt"</span>, <span class="string">'r+'</span>):</span><br><span class="line">    line = line.strip(<span class="string">'\n'</span>)</span><br><span class="line">    line = line.strip(<span class="string">'\t'</span>)</span><br><span class="line">    line = line.rstrip(<span class="string">','</span>)</span><br><span class="line">    line = line.lstrip(<span class="string">'"'</span>)</span><br><span class="line">    line = line.rstrip(<span class="string">'"'</span>)</span><br><span class="line">    corpus.append(line)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># === Record the text cut and POS === #</span></span><br><span class="line">part_of_speech = []</span><br><span class="line">word_after_cut = []</span><br><span class="line">cut_corpus_iter = corpus.copy()</span><br><span class="line">cut_corpus = corpus.copy()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(corpus)):</span><br><span class="line">    cut_corpus_iter[i] = pseg.cut(corpus[i])  <span class="comment"># 5316</span></span><br><span class="line">    cut_corpus[i] = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> every <span class="keyword">in</span> cut_corpus_iter[i]:</span><br><span class="line">        cut_corpus[i] = (cut_corpus[i] + <span class="string">" "</span> + str(every.word)).strip()</span><br><span class="line">        part_of_speech.append(every.flag)  <span class="comment"># 20640</span></span><br><span class="line">        word_after_cut.append(every.word)  <span class="comment"># 20640</span></span><br><span class="line">word_pos_dict = &#123;word_after_cut[i]: part_of_speech[i] <span class="keyword">for</span> i <span class="keyword">in</span> range(len(word_after_cut))&#125;  </span><br><span class="line"></span><br><span class="line"><span class="comment"># === Get new weight with POS considered === #</span></span><br><span class="line">word_weight = [<span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(len(word))]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(word)):</span><br><span class="line">    <span class="keyword">if</span> word[i] <span class="keyword">not</span> <span class="keyword">in</span> word_pos_dict.keys():</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> word_pos_dict[word[i]] == <span class="string">'n'</span>:</span><br><span class="line">        word_weight[i] = <span class="number">1.2</span></span><br><span class="line">    <span class="keyword">elif</span> word_pos_dict[word[i]] == <span class="string">"vn"</span>:</span><br><span class="line">        word_weight[i] = <span class="number">1.1</span></span><br><span class="line">    <span class="keyword">elif</span> word_pos_dict[word[i]] == <span class="string">"m"</span>:</span><br><span class="line">        word_weight[i] = <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:  <span class="comment"># 权重调整可以根据实际情况进行更改</span></span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">word_weight = np.array(word_weight)</span><br><span class="line">new_weight = weight.copy()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(weight)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(len(word)):</span><br><span class="line">        new_weight[i][j] = weight[i][j] * word_weight[j]</span><br><span class="line"></span><br><span class="line"><span class="comment"># === Fit the DBSCAN model and get the classify labels === #</span></span><br><span class="line">DBS_clf = DBSCAN(eps=<span class="number">1</span>, min_samples=<span class="number">4</span>)</span><br><span class="line">DBS_clf.fit(new_weight)</span><br><span class="line">print(DBS_clf.labels_)        </span><br><span class="line"> </span><br><span class="line"><span class="comment"># === Define the function of classify the original corpus according to the labels === #</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">labels_to_original</span><span class="params">(labels, original_corpus)</span>:</span></span><br><span class="line">    <span class="keyword">assert</span> len(labels) == len(original_corpus)</span><br><span class="line">    max_label = max(labels)</span><br><span class="line">    number_label = [i <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, max_label + <span class="number">1</span>, <span class="number">1</span>)]</span><br><span class="line">    number_label.append(<span class="number">-1</span>)</span><br><span class="line">    result = [[] <span class="keyword">for</span> i <span class="keyword">in</span> range(len(number_label))]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(labels)):</span><br><span class="line">        index = number_label.index(labels[i])</span><br><span class="line">        result[index].append(original_corpus[i])</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">labels_original = labels_to_original(DBS_clf.labels_, corpus)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">	print(labels_original[i])</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 聚类结果展示（部分）	</span></span><br><span class="line">[<span class="string">'社保卡'</span>, <span class="string">'社保卡'</span>, <span class="string">'社保卡。'</span>, <span class="string">'社保卡办理'</span>, <span class="string">'社保卡'</span>, <span class="string">'社保卡'</span>, <span class="string">'社保卡挂失'</span>, <span class="string">'社保卡。'</span>, <span class="string">'社保卡'</span>, <span class="string">'领取社保卡。'</span>]</span><br><span class="line">[<span class="string">'五险一金'</span>, <span class="string">'五险一金。'</span>, <span class="string">'五险一金。'</span>, <span class="string">'五险一金介绍'</span>, <span class="string">'看看二月份五险一金情况'</span>]</span><br><span class="line">[<span class="string">'打开汇钱。'</span>, <span class="string">'打开汇钱。'</span>, <span class="string">'我要汇钱'</span>, <span class="string">'我要汇钱。'</span>, <span class="string">'我要汇钱。'</span>, <span class="string">'我要汇钱。'</span>, <span class="string">'我要汇钱。'</span>, <span class="string">'我要汇钱。'</span>, <span class="string">'我要汇钱。'</span>]</span><br><span class="line">[<span class="string">'车辆通行证。'</span>, <span class="string">'车辆通行证。'</span>, <span class="string">'我要办车辆通行证。'</span>, <span class="string">'车辆通行证'</span>, <span class="string">'车辆通行证'</span>, <span class="string">'车辆通行证'</span>, <span class="string">'车辆通行证'</span>, <span class="string">'车辆通行证。'</span>, <span class="string">'车辆通行证'</span>, <span class="string">'车辆通行证。'</span>, <span class="string">'车辆通行证。'</span>, <span class="string">'车辆通行证'</span>]</span><br><span class="line">[<span class="string">'邮件附件权限'</span>, <span class="string">'等等邮件附件权限。'</span>, <span class="string">'邮件附件权限'</span>, <span class="string">'邮件附件权限'</span>, <span class="string">'邮件附件权限'</span>, <span class="string">'邮件附件权限'</span>, <span class="string">'您好，请问怎样申请图片查看权限和邮件附件查看权限？'</span>]</span><br></pre></td></tr></table></figure>

</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined" target="_blank" rel="noopener">Leon</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://dataquaner.github.io/2020/01/07/%E7%9F%AD%E6%96%87%E6%9C%AC%E8%81%9A%E7%B1%BB%E3%80%90DBSCAN%E3%80%91%E7%AE%97%E6%B3%95%E5%8E%9F%E7%90%86+Python%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0+%E8%81%9A%E7%B1%BB%E7%BB%93%E6%9E%9C%E5%B1%95%E7%A4%BA/">https://dataquaner.github.io/2020/01/07/%E7%9F%AD%E6%96%87%E6%9C%AC%E8%81%9A%E7%B1%BB%E3%80%90DBSCAN%E3%80%91%E7%AE%97%E6%B3%95%E5%8E%9F%E7%90%86+Python%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0+%E8%81%9A%E7%B1%BB%E7%BB%93%E6%9E%9C%E5%B1%95%E7%A4%BA/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://dataquaner.github.io">DataQuaner</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/DBSCAN/">DBSCAN    </a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button"><i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.jpg"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg"><div class="post-qr-code__desc">支付宝</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2020/01/07/DBSCAN%E7%AE%97%E6%B3%95python%E5%AE%9E%E7%8E%B0%EF%BC%88%E9%99%84%E5%AE%8C%E6%95%B4%E6%95%B0%E6%8D%AE%E9%9B%86%E5%92%8C%E4%BB%A3%E7%A0%81%EF%BC%89/"><img class="prev_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>DBSCAN算法python实现（附完整数据集和代码）</span></div></a></div><div class="next-post pull_right"><a href="/2020/01/07/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%B3%BB%E5%88%97%E4%B9%8B%E5%86%B3%E7%AD%96%E6%A0%91%E7%AE%97%E6%B3%95%EF%BC%8808%EF%BC%89%EF%BC%9A%E6%A2%AF%E5%BA%A6%E6%8F%90%E5%8D%87%E6%A0%91%E7%AE%97%E6%B3%95LightGBM/"><img class="next_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>机器学习系列之决策树算法(08):梯度提升树算法LightGBM</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/01/07/DBSCAN算法python实现（附完整数据集和代码）/" title="DBSCAN算法python实现（附完整数据集和代码）"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png"><div class="relatedPosts_title">DBSCAN算法python实现（附完整数据集和代码）</div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div id="disqus_thread"></div><script>var unused = null;
var disqus_config = function () {
  this.page.url = 'https://dataquaner.github.io/2020/01/07/%E7%9F%AD%E6%96%87%E6%9C%AC%E8%81%9A%E7%B1%BB%E3%80%90DBSCAN%E3%80%91%E7%AE%97%E6%B3%95%E5%8E%9F%E7%90%86+Python%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0+%E8%81%9A%E7%B1%BB%E7%BB%93%E6%9E%9C%E5%B1%95%E7%A4%BA/';
  this.page.identifier = '2020/01/07/短文本聚类【DBSCAN】算法原理+Python代码实现+聚类结果展示/';
  this.page.title = '短文本聚类【DBSCAN】算法原理+Python代码实现+聚类结果展示';
}
var d = document, s = d.createElement('script');
s.src = "https://" + 'dataquaner' +".disqus.com/embed.js";
s.setAttribute('data-timestamp', '' + +new Date());
(d.head || d.body).appendChild(s);</script></div></div></div><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2020 By Leon</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="footer_custom_text">Hi, welcome to my <a href="https://dataquaner.github.io/">blog</a>!</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="/js/baidupush.js"> </script><script src="/js/tw_cn.js"></script><script>translateInitilization()
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script></body></html>